"use strict";(globalThis["webpackChunkweb"]=globalThis["webpackChunkweb"]||[]).push([[137],{2343:(e,a,l)=>{l.d(a,{T:()=>o});l(9665);var t=l(4587),n=l.n(t),r=(l(4702),l(8646)),s=l.n(r);async function o(e){const a=n().map("leaflet-map").setView([25.056057,121.118849],14);n().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"© OpenStreetMap"}).addTo(a);const l=await Promise.all(e.map((e=>u(e.number)))),t=[];return e.forEach(((e,r)=>{const s=`<div>\n      <a href="/usrweb_frontend/#/instant/${e.id}/${e.name}/${e.number}">\n        <b>${e.id}.${e.name}<br>(${e.number})</b>\n      </a></div>`,o="\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 20px;\n      height: 20px;\n      background-color: #4572B6;\n      border-radius: 50%;\n      color: white;\n      font-size: 12px;",m=n().divIcon({className:"custom-icon",iconAnchor:[10,10],html:`<span style="${o}">${e.id}</span>`}),c=n().marker(e.local,{title:e.name,icon:m}).addTo(a),d=n().heatLayer([],{radius:25,gradient:{0:i(l[r])},useLocalExtrema:!0}).addTo(a);t.push(d),c.bindPopup(s);const p=[],h=setInterval((async()=>{const a=await u(e.number);d.setLatLngs([[e.local[0],e.local[1],parseFloat(a)]]);const l=i(a);d.setOptions({gradient:{0:l}})}),1e4);p.push(h)})),{map:a,pm25Values:l,heatmapLayers:t}}async function u(e){try{const a=await fetch("https://usrweb-backend.onrender.com"),l=await a.json(),t=l.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/pm2_5/rawdata`));if(t.length>0){const e=JSON.parse(t[t.length-1].payload),a=e.value[0];return parseFloat(a).toFixed(1)}return null}catch(a){return console.error(`Error fetching pm2_5 value for sensor ${e}:`,a),null}}function i(e){return s().scale(["green","yellow","orange","red","purple","darkred"]).domain([0,15.5,35.5,54.5,150.5,250.5])(e).hex()}},7557:(e,a,l)=>{l.d(a,{A:()=>n});var t=l(499);const n=(0,t.iH)([{id:1,name:"成功路二段之一 ",number:10605260677,local:[25.0428733,121.1059416]},{id:2,name:"工業七路之一 ",number:10605561745,local:[25.05554,121.1037596]},{id:3,name:"工業七路之二 ",number:10606216061,local:[25.0506438,121.1079635]},{id:4,name:"國建三路之一 ",number:10604019880,local:[25.0583648,121.1066816]},{id:5,name:"國建三路之二 ",number:10607619833,local:[25.0618705,121.1114958]},{id:6,name:"工業五路 ",number:10606080586,local:[25.0557956,121.116104]},{id:7,name:"經建七路 ",number:10606791192,local:[25.0637683,121.1137465]},{id:8,name:"經建六路之一 ",number:10600992447,local:[25.064804,121.1212996]},{id:9,name:"經建六路之二 ",number:10606521585,local:[25.0621433,121.1149825]},{id:10,name:"經建三路 ",number:10607952090,local:[25.0618571,121.1254425]},{id:11,name:"經建四路之一 ",number:10607724246,local:[25.059183,121.1168746]},{id:12,name:"經建四路之二 ",number:10603726902,local:[25.0614241,121.1223373]},{id:13,name:"經建三路 ",number:10599319281,local:[25.0588396,121.121315]},{id:14,name:"經建一路之一 ",number:10604686736,local:[25.0543936,121.1174926]},{id:15,name:"經建一路之二 ",number:10603668681,local:[25.0557211,121.1204756]},{id:16,name:"經建一路之三 ",number:10601302002,local:[25.057598,121.1250838]},{id:17,name:"經建二路 ",number:10605151824,local:[25.0607813,121.1258238]},{id:18,name:"工業二路之一 ",number:10605427617,local:[25.0678558,121.1239241]},{id:19,name:"工業二路之二 ",number:10607054865,local:[25.062601,121.128517]},{id:20,name:"工業一路 ",number:10605788250,local:[25.0664443,121.1277236]},{id:21,name:"成功路二段之二 ",number:10599287416,local:[25.060357,121.118849]},{id:22,name:"成功路二段之三 ",number:10602689216,local:[25.0476321,121.1123351]},{id:23,name:"成功路一段之一 ",number:10602868637,local:[25.0527686,121.1195296]},{id:24,name:"成功路一段之二 ",number:10612031741,local:[25.055072,121.127096]},{id:25,name:"榮工北路 ",number:10600397665,local:[25.0583228,121.1298293]},{id:26,name:"工業六路 ",number:10600025221,local:[25.0484313,121.1161726]},{id:27,name:"大同二路 ",number:10606666685,local:[25.0487823,121.1348036]},{id:28,name:"大同一路之一 ",number:10602079644,local:[25.0509241,121.1272353]},{id:29,name:"大同一路之二 ",number:10607422041,local:[25.0459708,121.1328581]},{id:30,name:"榮工南路 ",number:10601018051,local:[25.0529078,121.130432]}])},6137:(e,a,l)=>{l.r(a),l.d(a,{default:()=>U});var t=l(9835),n=l(6970);const r=(0,t._)("img",{src:"https://i.imgur.com/ERQf7FQ.png"},null,-1),s=(0,t._)("strong",null,"地點｜Locations",-1),o={style:{"max-width":"330px"}},u={key:0,class:"q-flex"},i={class:"q-pa-md example-col-gutter-horizontal"},m={class:"row q-col-gutter-x-lg"},c={class:"col-3"},d=(0,t._)("div",{class:"content text-bold"},"溫度(℃)",-1),p={class:"col-3"},h=(0,t._)("div",{class:"content text-bold"},"濕度(%)",-1),w={class:"col-3"},b=(0,t._)("div",{class:"content text-bold"},"PM2.5濃度(μg/m3)",-1),f={class:"col-3"},g=(0,t._)("div",{class:"content text-bold"},"VOC(ppb)",-1),v=(0,t._)("img",{src:"https://i.imgur.com/ERQf7FQ.png"},null,-1),_=(0,t._)("strong",null,"熱點地圖｜Map (若無熱點顯示，請稍等片刻；若為灰色，則為無資料)",-1),q=(0,t._)("div",{id:"leaflet-map",style:{width:"100%",height:"400px"}},null,-1);function x(e,a,l,x,y,k){const W=(0,t.up)("q-avatar"),V=(0,t.up)("q-item-section"),$=(0,t.up)("q-item-label"),j=(0,t.up)("q-btn"),z=(0,t.up)("q-item"),Q=(0,t.up)("q-separator"),S=(0,t.up)("q-list"),Z=(0,t.up)("q-icon"),F=(0,t.up)("q-card-section"),L=(0,t.up)("q-spinner"),T=(0,t.up)("q-card"),I=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(I,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S,{separator:""},{default:(0,t.w5)((()=>[(0,t.Wm)(z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,{avatar:"",top:""},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{square:"",size:"md",class:"q-mt-sm"},{default:(0,t.w5)((()=>[r])),_:1})])),_:1}),(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)($,{class:"text-subtitleText1 q-mt-md"},{default:(0,t.w5)((()=>[s])),_:1})])),_:1}),(0,t.Wm)(j,{flat:"",color:"blue",icon:e.matArrowBack,label:"返回上一頁",onClick:a[0]||(a[0]=a=>e.$router.go(-1)),style:{"font-weight":"bold"}},null,8,["icon"])])),_:1}),(0,t.Wm)(Q,{class:"q-itemider",size:"5px",color:"transparent"}),(0,t._)("div",o,[(0,t.Wm)(S,{separator:"",class:"title text-bold q-ml-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.$route.params.id)+". "+(0,n.zw)(e.$route.params.name)+"("+(0,n.zw)(e.$route.params.number)+")",1)])),_:1})])),_:1})])),_:1})]),(0,t.Wm)(Q,{class:"q-itemider",size:"10px",color:"transparent"}),(0,t._)("div",null,[e.showSpinner?((0,t.wg)(),(0,t.iD)("strong",u,[(0,t.Wm)(Z,{name:"hourglass_empty",size:"sm",class:"q-ml-xl"}),(0,t.Uk)("資料讀取需要一點時間，請稍等片刻... ")])):(0,t.kq)("",!0)])])),_:1}),(0,t._)("div",i,[(0,t._)("div",m,[(0,t._)("div",c,[d,(0,t.Wm)(T,{square:"",flat:"",class:"mqtt-place q-pa-xl"},{default:(0,t.w5)((()=>[null!==e.temperatureValue?((0,t.wg)(),(0,t.j4)(F,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.temperatureValue),1)])),_:1})):((0,t.wg)(),(0,t.j4)(F,{key:1},{default:(0,t.w5)((()=>[(0,t.Wm)(L)])),_:1}))])),_:1})]),(0,t._)("div",p,[h,(0,t.Wm)(T,{square:"",flat:"",class:"mqtt-place q-pa-xl"},{default:(0,t.w5)((()=>[null!==e.humidityValue?((0,t.wg)(),(0,t.j4)(F,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.humidityValue),1)])),_:1})):((0,t.wg)(),(0,t.j4)(F,{key:1},{default:(0,t.w5)((()=>[(0,t.Wm)(L)])),_:1}))])),_:1})]),(0,t._)("div",w,[b,(0,t.Wm)(T,{square:"",flat:"",class:"mqtt-place q-pa-xl"},{default:(0,t.w5)((()=>[null!==e.pm25Value?((0,t.wg)(),(0,t.j4)(F,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.pm25Value),1)])),_:1})):((0,t.wg)(),(0,t.j4)(F,{key:1},{default:(0,t.w5)((()=>[(0,t.Wm)(L)])),_:1}))])),_:1})]),(0,t._)("div",f,[g,(0,t.Wm)(T,{square:"",flat:"",class:"mqtt-place q-pa-xl"},{default:(0,t.w5)((()=>[null!==e.pm25Value?((0,t.wg)(),(0,t.j4)(F,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.vocValue),1)])),_:1})):((0,t.wg)(),(0,t.j4)(F,{key:1},{default:(0,t.w5)((()=>[e.showSpinner?((0,t.wg)(),(0,t.j4)(L,{key:0})):(0,t.kq)("",!0)])),_:1}))])),_:1})])])]),(0,t.Wm)(S,null,{default:(0,t.w5)((()=>[(0,t.Wm)(z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(V,{avatar:"",top:""},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{square:"",size:"md",class:"q-mt-sm"},{default:(0,t.w5)((()=>[v])),_:1})])),_:1}),(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)($,{class:"text-subtitleText1 q-mt-md"},{default:(0,t.w5)((()=>[_])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(Q,{class:"q-itemider",size:"15px",color:"transparent"}),(0,t._)("div",null,[(0,t.Wm)(S,{class:"q-ml-md q-mr-xl q-pr-md"},{default:(0,t.w5)((()=>[q])),_:1})]),(0,t.Wm)(Q,{class:"q-itemider",size:"50px",color:"transparent"})])),_:1})}var y=l(2343),k=l(7557),W=l(6060);const V=(0,t.aZ)({name:"InstantPage",data(){return{pm25Value:null,temperatureValue:null,humidityValue:null,vocValue:null,colorBarStops:[0,15.5,35.5,54.5,150.5,250.5],showSpinner:!0}},setup(){return(0,t.bv)((()=>{(0,y.T)(k.A.value)})),{titleList:k.A,matArrowBack:W.d2z}},mounted(){this.fetchMessages(this.$route.params.number),setInterval((()=>this.fetchMessages(this.$route.params.number)),1e3)},methods:{fetchMessages(e){this.isLocationLoading=!0;let a="https://usrweb-backend.onrender.com";fetch(a).then((e=>e.json())).then((a=>{const l=a.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/pm2_5/rawdata`));if(l.length>0){const e=JSON.parse(l[l.length-1].payload),a=e.value[0];this.pm25Value=parseFloat(a).toFixed(1)}else this.pm25Value=null;const t=a.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/temperature/rawdata`));if(t.length>0){const e=JSON.parse(t[t.length-1].payload),a=e.value[0];this.temperatureValue=parseFloat(a).toFixed(1)}else this.temperatureValue=null;const n=a.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/humidity/rawdata`));if(n.length>0){const e=JSON.parse(n[n.length-1].payload),a=e.value[0];this.humidityValue=parseFloat(a).toFixed(0)}else this.humidityValue=null;const r=a.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/voc/rawdata`));if(r.length>0){const e=JSON.parse(r[r.length-1].payload),a=e.value[0];this.vocValue=parseFloat(a).toFixed(0)}else this.vocValue=null;const s=null!==this.pm25Value||null!==this.temperatureValue||null!==this.humidityValue||null!==this.vocValue;s&&(this.showSpinner=!1)})).catch((e=>{console.error("Error fetching messages:",e)}))}}});var $=l(1639),j=l(9885),z=l(3246),Q=l(490),S=l(1233),Z=l(1357),F=l(3115),L=l(8879),T=l(926),I=l(2857),O=l(4458),A=l(3190),C=l(3940),E=l(9984),M=l.n(E);const N=(0,$.Z)(V,[["render",x]]),U=N;M()(V,"components",{QPage:j.Z,QList:z.Z,QItem:Q.Z,QItemSection:S.Z,QAvatar:Z.Z,QItemLabel:F.Z,QBtn:L.Z,QSeparator:T.Z,QIcon:I.Z,QCard:O.Z,QCardSection:A.Z,QSpinner:C.Z})}}]);