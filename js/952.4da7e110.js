"use strict";(globalThis["webpackChunkweb"]=globalThis["webpackChunkweb"]||[]).push([[952],{2343:(e,a,n)=>{n.d(a,{T:()=>s});n(9665);var t=n(4587),l=n.n(t),r=(n(4702),n(8646)),o=n.n(r);async function s(e){const a=l().map("leaflet-map").setView([25.056057,121.118849],14);l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"© OpenStreetMap"}).addTo(a);const n=await Promise.all(e.map((e=>m(e.number)))),t=[];return e.forEach(((e,r)=>{const o=`<div>\n      <a href="/usrweb_frontend/#/instant/${e.id}/${e.name}/${e.number}">\n        <b>${e.id}.${e.name}<br>(${e.number})</b>\n      </a></div>`,s="\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 20px;\n      height: 20px;\n      background-color: #4572B6;\n      border-radius: 50%;\n      color: white;\n      font-size: 12px;",c=l().divIcon({className:"custom-icon",iconAnchor:[10,10],html:`<span style="${s}">${e.id}</span>`}),u=l().marker(e.local,{title:e.name,icon:c}).addTo(a),d=l().heatLayer([],{radius:25,gradient:{0:i(n[r])},useLocalExtrema:!0}).addTo(a);t.push(d),u.bindPopup(o);const p=[],b=setInterval((async()=>{const a=await m(e.number);d.setLatLngs([[e.local[0],e.local[1],parseFloat(a)]]);const n=i(a);d.setOptions({gradient:{0:n}})}),1e4);p.push(b)})),{map:a,pm25Values:n,heatmapLayers:t}}async function m(e){try{const a=await fetch("https://usrweb-backend.onrender.com"),n=await a.json(),t=n.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/pm2_5/rawdata`));if(t.length>0){const e=JSON.parse(t[t.length-1].payload),a=e.value[0];return parseFloat(a).toFixed(1)}return null}catch(a){return console.error(`Error fetching pm2_5 value for sensor ${e}:`,a),null}}function i(e){return o().scale(["green","yellow","orange","red","purple","darkred"]).domain([0,15.5,35.5,54.5,150.5,250.5])(e).hex()}},7557:(e,a,n)=>{n.d(a,{A:()=>l});var t=n(499);const l=(0,t.iH)([{id:1,name:"成功路二段之一 ",number:10605260677,local:[25.0428733,121.1059416]},{id:2,name:"工業七路之一 ",number:10605561745,local:[25.05554,121.1037596]},{id:3,name:"工業七路之二 ",number:10606216061,local:[25.0506438,121.1079635]},{id:4,name:"國建三路之一 ",number:10604019880,local:[25.0583648,121.1066816]},{id:5,name:"國建三路之二 ",number:10607619833,local:[25.0618705,121.1114958]},{id:6,name:"工業五路 ",number:10606080586,local:[25.0557956,121.116104]},{id:7,name:"經建七路 ",number:10606791192,local:[25.0637683,121.1137465]},{id:8,name:"經建六路之一 ",number:10600992447,local:[25.064804,121.1212996]},{id:9,name:"經建六路之二 ",number:10606521585,local:[25.0621433,121.1149825]},{id:10,name:"經建三路 ",number:10607952090,local:[25.0618571,121.1254425]},{id:11,name:"經建四路之一 ",number:10607724246,local:[25.059183,121.1168746]},{id:12,name:"經建四路之二 ",number:10603726902,local:[25.0614241,121.1223373]},{id:13,name:"經建三路 ",number:10599319281,local:[25.0588396,121.121315]},{id:14,name:"經建一路之一 ",number:10604686736,local:[25.0543936,121.1174926]},{id:15,name:"經建一路之二 ",number:10603668681,local:[25.0557211,121.1204756]},{id:16,name:"經建一路之三 ",number:10601302002,local:[25.057598,121.1250838]},{id:17,name:"經建二路 ",number:10605151824,local:[25.0607813,121.1258238]},{id:18,name:"工業二路之一 ",number:10605427617,local:[25.0678558,121.1239241]},{id:19,name:"工業二路之二 ",number:10607054865,local:[25.062601,121.128517]},{id:20,name:"工業一路 ",number:10605788250,local:[25.0664443,121.1277236]},{id:21,name:"成功路二段之二 ",number:10599287416,local:[25.060357,121.118849]},{id:22,name:"成功路二段之三 ",number:10602689216,local:[25.0476321,121.1123351]},{id:23,name:"成功路一段之一 ",number:10602868637,local:[25.0527686,121.1195296]},{id:24,name:"成功路一段之二 ",number:10612031741,local:[25.055072,121.127096]},{id:25,name:"榮工北路 ",number:10600397665,local:[25.0583228,121.1298293]},{id:26,name:"工業六路 ",number:10600025221,local:[25.0484313,121.1161726]},{id:27,name:"大同二路 ",number:10606666685,local:[25.0487823,121.1348036]},{id:28,name:"大同一路之一 ",number:10602079644,local:[25.0509241,121.1272353]},{id:29,name:"大同一路之二 ",number:10607422041,local:[25.0459708,121.1328581]},{id:30,name:"榮工南路 ",number:10601018051,local:[25.0529078,121.130432]}])},6952:(e,a,n)=>{n.r(a),n.d(a,{default:()=>Q});var t=n(9835),l=n(6970);const r=e=>((0,t.dD)("data-v-ddc64d80"),e=e(),(0,t.Cn)(),e),o=r((()=>(0,t._)("img",{src:"https://i.imgur.com/ERQf7FQ.png"},null,-1))),s=r((()=>(0,t._)("strong",null,"地點｜Locations",-1))),m={class:"example-col-gutter-vertical text-bold"},i={class:"row q-col-gutter-y-none"},c=r((()=>(0,t._)("img",{src:"https://i.imgur.com/ERQf7FQ.png"},null,-1))),u=r((()=>(0,t._)("strong",null,"熱點地圖｜Map (若無熱點顯示，請稍等片刻；若為灰色，則為無資料)",-1))),d=r((()=>(0,t._)("div",{id:"leaflet-map",style:{width:"100%",height:"400px"}},null,-1)));function p(e,a,n,r,p,b){const h=(0,t.up)("q-avatar"),g=(0,t.up)("q-item-section"),f=(0,t.up)("q-item-label"),w=(0,t.up)("q-item"),v=(0,t.up)("q-list"),_=(0,t.up)("q-separator"),x=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(x,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,{separator:""},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(g,{avatar:"",top:""},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{square:"",size:"md",class:"q-mt-sm"},{default:(0,t.w5)((()=>[o])),_:1})])),_:1}),(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"text-subtitleText1 q-mt-md"},{default:(0,t.w5)((()=>[s])),_:1})])),_:1})])),_:1})])),_:1}),(0,t._)("div",m,[(0,t._)("div",i,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.titleList,(a=>((0,t.wg)(),(0,t.j4)(w,{key:a.id,onClick:n=>e.navigateToTitle(a.id,a.name,a.number),clickable:"",class:"col-4 my-content"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,l.zw)(a.id)+"."+(0,l.zw)(a.name)+"("+(0,l.zw)(a.number)+") ",1)])),_:2},1032,["onClick"])))),128))])]),(0,t.Wm)(_,{class:"q-itemider",size:"25px",color:"transparent"}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(g,{avatar:"",top:""},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{square:"",size:"md",class:"q-mt-sm"},{default:(0,t.w5)((()=>[c])),_:1})])),_:1}),(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"text-subtitleText1 q-mt-md"},{default:(0,t.w5)((()=>[u])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(_,{class:"q-itemider",size:"15px",color:"transparent"}),(0,t._)("div",null,[(0,t.Wm)(v,{class:"q-ml-md q-mr-xl q-pr-md"},{default:(0,t.w5)((()=>[d])),_:1})]),(0,t.Wm)(_,{class:"q-itemider",size:"50px",color:"transparent"})])),_:1})}n(9665);var b=n(8339),h=n(7557),g=n(2343);const f=(0,t.aZ)({name:"IndexPage",data(){return{pm25Value:null,colorBarStops:[0,15.5,35.5,54.5,150.5,250.5]}},setup(){const e=(0,b.tv)();(0,t.bv)((()=>{(0,g.T)(h.A.value)}));const a=(a,n,t)=>{e.push({name:"InstantPage",params:{id:a,name:n,number:t}})};return{titleList:h.A,navigateToTitle:a}},mounted(){this.fetchMessages(this.$route.params.number),setInterval((()=>this.fetchMessages(this.$route.params.number)),3e4)},methods:{fetchMessages(e){let a="https://usrweb-backend.onrender.com";a=process.env.VUE_APP_PRO_API_URL,fetch(a).then((e=>e.json())).then((a=>{console.log("production");const n=a.filter((a=>a.topic===`/v1/project/1147/device/${e}/sensor/pm2_5/rawdata`));if(n.length>0){const e=JSON.parse(n[n.length-1].payload),a=e.value[0];this.pm25Value=parseFloat(a).toFixed(1)}else this.pm25Value=null})).catch((e=>{console.error("Error fetching messages:",e)}))}}});var w=n(1639),v=n(9885),_=n(3246),x=n(490),q=n(1233),y=n(1357),W=n(3115),k=n(926),T=n(9984),$=n.n(T);const L=(0,w.Z)(f,[["render",p],["__scopeId","data-v-ddc64d80"]]),Q=L;$()(f,"components",{QPage:v.Z,QList:_.Z,QItem:x.Z,QItemSection:q.Z,QAvatar:y.Z,QItemLabel:W.Z,QSeparator:k.Z})}}]);